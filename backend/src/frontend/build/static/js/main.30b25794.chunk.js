(this["webpackJsonpchat-app"]=this["webpackJsonpchat-app"]||[]).push([[0],{122:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),s=a(51),c=a.n(s),o=a(2),u=a(61),i=a(52),l=a(53),m=a(54),p=a(62),d=a(55),f=a(15),b=a(63),h=a(56),E=a.n(h),O=a(11),v=a.n(O),g=a(16),j=function(e){var t=e.sendMessage,a=Object(r.useState)(""),s=Object(o.a)(a,2),c=s[0],u=s[1],i=function(){t({message:c}),u("")};return n.a.createElement("div",{className:"form-group"},n.a.createElement("form",{onSubmit:function(e){e.preventDefault(),i()},id:"inputBar"},n.a.createElement("input",{autoComplete:"off",type:"text",className:"form-control",placeholder:"Send message",id:"inputDefault",onChange:function(e){u(e.target.value)},value:c}),n.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:i,id:"submitButton"},"Send")))},y=a(57),w=a.n(y),k=function(e){var t=e.sender,a=e.text,r=e.createdAt;return n.a.createElement("div",{className:"card"},n.a.createElement("div",{className:"card-body"},n.a.createElement("h6",{className:"card-subtitle mb-2 text-muted"},t,", ",w()(r).format("Do, h:mm a")),n.a.createElement("p",{className:"card-text"},a)))},S=a(17),M=a.n(S),N=function(e){var t=e.room,a=e.newMessages,s=e.sendMessage,c=Object(r.useState)([]),u=Object(o.a)(c,2),i=u[0],l=u[1],m=Object(r.useRef)(null);return Object(r.useEffect)((function(){!function(){var e=Object(g.a)(v.a.mark((function e(){var a;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M.a.get("https://chat-app-sean-fahy.herokuapp.com/messages/".concat(t));case 2:a=e.sent,l(a.data);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t]),Object(r.useEffect)((function(){m.current.scrollIntoView({behavior:"smooth",block:"start"})}),[a]),n.a.createElement("div",{id:"chat-window"},n.a.createElement("div",{id:"messages"},i.map((function(e){return n.a.createElement(k,{sender:e.sender,key:e._id,text:e.message,createdAt:e.createdAt})})),a.map((function(e){return n.a.createElement(k,{sender:e.sender,key:e._id,text:e.message,createdAt:e.createdAt})})),n.a.createElement("div",{ref:m})),n.a.createElement(j,{sendMessage:s}))},x=function(e){var t=e.username;return n.a.createElement("h4",null,t)},U=function(e){var t=e.room,a=e.presentUsers;return n.a.createElement("div",{id:"currentUsers"},n.a.createElement("h1",null,"Room: ",t),n.a.createElement("div",{id:"seperatingDiv"}),n.a.createElement("h2",null,"Active users:"),n.a.createElement("div",{id:"presentUsers"},a.map((function(e){return n.a.createElement(x,{username:e.username,key:e.ID})}))))};function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function C(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(a,!0).forEach((function(t){Object(i.a)(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var D=function(e){function t(e){var a;return Object(l.a)(this,t),(a=Object(p.a)(this,Object(d.a)(t).call(this,e))).sendMessage=function(e){e.room=this.props.room,e.sender=this.props.username,this.state.socket.emit("sendMessage",e)},a.sendMessage=a.sendMessage.bind(Object(f.a)(a)),a.state={socket:E()("https://chat-app-sean-fahy.herokuapp.com:".concat(Object({NODE_ENV:"production",PUBLIC_URL:""}).SOCKETIO_PORT)),newMessages:[],presentUsers:[]},a}return Object(b.a)(t,e),Object(m.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.state.socket.emit("join",{room:this.props.room,username:this.props.username}),this.state.socket.on("message",(function(t){e.setState(C({},e.state,{newMessages:[].concat(Object(u.a)(e.state.newMessages),[t])}))})),this.state.socket.on("presentUsers",(function(t){e.setState(C({},e.state,{presentUsers:t}))}))}},{key:"render",value:function(){return n.a.createElement("div",{id:"chatPage"},n.a.createElement(U,{room:this.props.room,presentUsers:this.state.presentUsers}),n.a.createElement(N,{room:this.props.room,username:this.props.username,newMessages:this.state.newMessages,sendMessage:this.sendMessage}))}}]),t}(n.a.Component),A=function(e){var t=e.errorMessage,a=e.setShowError;return Object(r.useEffect)((function(){setTimeout((function(){a(!1)}),4e3)}),[a]),n.a.createElement("div",{className:"alert alert-dismissible alert-danger"},n.a.createElement("strong",null,"Error!")," ",n.a.createElement("p",null,t))},R=function(e){var t=e.setRoom,a=e.setUsername,s=e.setAuth,c=Object(r.useState)(""),u=Object(o.a)(c,2),i=u[0],l=u[1],m=Object(r.useState)(""),p=Object(o.a)(m,2),d=p[0],f=p[1],b=Object(r.useState)(""),h=Object(o.a)(b,2),E=h[0],O=h[1],j=Object(r.useState)(!1),y=Object(o.a)(j,2),w=y[0],k=y[1],S=Object(r.useState)(""),N=Object(o.a)(S,2),x=N[0],U=N[1];function P(){return(P=Object(g.a)(v.a.mark((function e(){var r;return v.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i&&d&&E){e.next=4;break}return U("Ensure a username, password and room are provided"),k(!0),e.abrupt("return");case 4:if(!(d.length<7)){e.next=8;break}return U("Password must have at least 7 characters"),k(!0),e.abrupt("return");case 8:return t(E),a(i),e.prev=10,e.next=13,M.a.post("https://chat-app-sean-fahy.herokuapp.com/users",{username:i,password:d});case 13:201===(r=e.sent).status||202===r.status?s(!0):200===r.status&&(U("Incorrect password"),k(!0)),e.next=19;break;case 17:e.prev=17,e.t0=e.catch(10);case 19:case"end":return e.stop()}}),e,null,[[10,17]])})))).apply(this,arguments)}return n.a.createElement("div",{id:"formWindow"},n.a.createElement("div",{className:"card signupform"},n.a.createElement("div",{className:"card-body"},n.a.createElement("h4",{className:"card-title"},"Sign Up / Login & Join room"),n.a.createElement("form",{onSubmit:function(e){e.preventDefault()}},n.a.createElement("label",null,"Username"),n.a.createElement("input",{autoComplete:"off",onChange:function(e){l(e.target.value)},type:"text",className:"form-control",name:"username",placeholder:"Username",id:"UsernameInput",required:!0}),n.a.createElement("label",null,"Password"),n.a.createElement("input",{autoComplete:"off",onChange:function(e){f(e.target.value)},type:"password",className:"form-control",placeholder:"Password",required:!0}),n.a.createElement("label",null,"Room"),n.a.createElement("input",{autoComplete:"off",onChange:function(e){O(e.target.value)},type:"text",className:"form-control",name:"room",placeholder:"Room",required:!0}),n.a.createElement("button",{className:"btn btn-primary",id:"signup-button",onClick:function(){return P.apply(this,arguments)}},"Join"))),w&&n.a.createElement(A,{errorMessage:x,setShowError:k})))},I=a(58),_=a(8);var B=function(){var e=Object(r.useState)(!1),t=Object(o.a)(e,2),a=t[0],s=t[1],c=Object(r.useState)(null),u=Object(o.a)(c,2),i=u[0],l=u[1],m=Object(r.useState)(null),p=Object(o.a)(m,2),d=p[0],f=p[1];return n.a.createElement(r.StrictMode,null,n.a.createElement(I.a,null,n.a.createElement(_.c,null,a&&n.a.createElement(_.a,{render:function(){return n.a.createElement(D,{room:d,username:i})}}),n.a.createElement(_.a,{render:function(){return n.a.createElement(R,{setAuth:s,setRoom:f,setUsername:l})}}))))};c.a.render(n.a.createElement(B,null),document.getElementById("root"))},64:function(e,t,a){e.exports=a(122)},97:function(e,t){}},[[64,1,2]]]);
//# sourceMappingURL=main.30b25794.chunk.js.map